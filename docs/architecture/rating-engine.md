---
sidebar_position: 7
---



# Rating Engine
---

Version 1 of the Rating Engine was designed specifically for the Solace Portfolio Insurance. The two main pillars of the engine are:

### [<u>Get Balances:</u>](https://github.com/solace-fi/solace-risk-api/tree/main/api/balances) Aggregates Position from an Address

In order to assess the premium, Solace collects the positions in user wallets through the balances method. This is done with Zapper APIs using the following two parameters:  

1. Wallet address
2. List of chain IDs (The balances in USD are aggregated for each protocol in the account across different chains)

### [<u>Get Scores:</u>](https://github.com/solace-fi/solace-risk-api/tree/main/api/scores) Calculates the Premium for the Portfolio in Each Account

The rating engine uses the following parameters and look up tables to evaluate the total premium: 

1. Account
2. Positions

For each position, the unique ID of the protocol and its position size in USD is required.

## Lookup Tables

There are currently four lookup tables needed to calculate the premium for the portfolio of positions:

1. Rate Table: Contains the rate values for each risk tier. Risk rate online (RROL) covers expected loss, risk load covers unexpected loss, and  rate on line (ROL) is the rate after being adjusted for unexpected loss.
2. Category correlation matrix with values for each supported category generated by expert judgment.
3. Correlation value table with correlation values to generate correlation matrices for each category separately.
4. Protocol tier map that lists all of the supported protocols, as well as their category and risk tier ranking.

Together, these lookup tables form the main components of the rating series.

### Wallet Cover over Stacked Cover

Instead of aggregating risk loads by each protocol, Solace aggregates by category. That allows us to diversify the risk load so that the total premium for the whole account ends up being less expensive than buying cover for each position in the portfolio. The discount varies depending on the structure of the portfolio, but a discount anywhere between 10-20% can be expected for an account with multiple positions.


Below is an example of an account with positions in six protocols: Alchemix, AAVE-V2, Compound, Curve, Liquity, and Notional Finance. For a balance of 2000 USD in each position, we can see that the annual premium is cheaper than buying a cover for each position separately. This does not take into account the associated cost with buying separate covers, which is another benefit of buying Solace Portfolio Insurance.

| - | Risk Premium | Rate on line |
|---|--------------|--------------|
| Account cover | 236 USD | 1.97% |
| Stacked cover | 261 USD | 2.18% |
| Discount 	| $25 USD / 10% | - |